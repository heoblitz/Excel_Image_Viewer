<!doctype html>
<html lang="ko">
    <head>
        <meta charset="utf-8">
        <title>엑셀 이미지 뷰어</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.5/xlsx.full.min.js"></script>
    </head>

    <body>
        <div class="header">
            <div class="document-header">
                <h1 class="document-title">엑셀 이미지 뷰어</h1>
            </div>
        </div>
        <div class="container">
            <input type="file" onchange="readExcel()">
            <div id="root"></div>
        </div>
        <script type="text/javascript">
            let root = document.getElementById("root");

            function readExcel() {
                let input = event.target;
                let reader = new FileReader();
                reader.onload = function () {
                    let data = reader.result;
                    let workBook = XLSX.read(data, { type: 'binary' });
                    workBook.SheetNames.forEach(function (sheetName) {
                        console.log('SheetName: ' + sheetName);
                        let rows = XLSX.utils.sheet_to_json(workBook.Sheets[sheetName]);
                        console.log(rows, typeof rows)
                        // console.log(JSON.stringify(rows));
                        // et excel = JSON.stringify(rows);
                        parseUrl(rows);
                    })
                };
                reader.readAsBinaryString(input.files[0]);
            }

            function parseUrl(rows) {
                console.log(rows)
                rows.forEach ((row) =>
                    appendImageComponent(row["제목"])
                );
            }

            function appendImageComponent(url) {
                let elem = document.createElement("img");
                elem.setAttribute("src", url);
                elem.setAttribute("height", "100");
                elem.setAttribute("width", "100");

                root.appendChild(elem);
            }
        </script>
    </body>
</html>